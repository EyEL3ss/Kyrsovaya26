<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="UltimateWalletFinal.Views.ListPage"
             Title="Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¾ÐºÐ½Ð¾">
    <RefreshView x:Name="refreshView"
                 IsRefreshing="False"
                 RefreshColor="#2196F3"
                 Refreshing="OnRefreshing">

        <ScrollView>
            <VerticalStackLayout Spacing="15" Padding="10">

                <!-- ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ -->
                <Border StrokeShape="RoundRectangle 10" Padding="15"
                       BackgroundColor="#E3F2FD">
                    <VerticalStackLayout>
                        <Label Text="Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ!"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#2196F3" />
                        <Label x:Name="userGreetingLabel"
                               FontSize="14"
                               TextColor="#1565C0" />
                        <Label x:Name="cardsCountLabel"
                               FontSize="12"
                               TextColor="#5C6BC0" />
                    </VerticalStackLayout>
                </Border>
                <SearchBar x:Name="searchBar"
           Placeholder="ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ ÐºÐ°Ñ€Ñ‚Ñ‹..."
           TextChanged="OnSearchTextChanged"
           CancelButtonColor="#2196F3" />
                <!-- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð¸ Ð¿Ð¾Ð¸ÑÐº -->
                <Grid RowDefinitions="Auto, *, Auto" 
      ColumnDefinitions="*, *">
                    <VerticalStackLayout Spacing="10">

                        

                        <HorizontalStackLayout Spacing="10">
                            <Button Text="Ð˜Ð·Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ"
                                    Clicked="OnFavoritesClicked"
                                    CornerRadius="10"

TextColor="White"
FontSize="10"
HeightRequest="35" />

                            <Button Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ"
                                    Clicked="OnAddCardClicked"
                                    CornerRadius="10"
TextColor="White"
FontSize="10"
HeightRequest="35"/>
                        </HorizontalStackLayout>
                        <Button Text="Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°"
                                    Clicked="OnSortClicked" CornerRadius="10" TextColor="White"
FontSize="10"
HeightRequest="35" />
                        <Button Text="test"
                                    Clicked="testpagenavi"
                                    CornerRadius="10"
TextColor="White"
FontSize="10"
HeightRequest="35"/>
                    </VerticalStackLayout>
                </Grid>

                <!-- Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ -->
                <ActivityIndicator x:Name="loadingIndicator"
                                   IsVisible="False"
                                   IsRunning="False"
                                   Color="#2196F3"
                                   HorizontalOptions="Center"
                                   HeightRequest="50" />

                <!-- Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ ÐµÑÐ»Ð¸ Ð½ÐµÑ‚ ÐºÐ°Ñ€Ñ‚ -->
                <Border x:Name="emptyStateFrame"
                       IsVisible="False"
                       Padding="20"
                       StrokeShape="RoundRectangle 10"
                       BackgroundColor="#FFF3E0">
                    <VerticalStackLayout HorizontalOptions="Center">
                        <Label Text="ðŸ“­"
                               FontSize="40"
                               HorizontalOptions="Center" />
                        <Label Text="Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ ÐºÐ°Ñ€Ñ‚"
                               FontSize="16"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="#EF6C00" />
                        <Label Text="ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ 'Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ', Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ€Ð²ÑƒÑŽ ÐºÐ°Ñ€Ñ‚Ñƒ"
                               FontSize="12"
                               HorizontalOptions="Center"
                               TextColor="#EF6C00"
                               HorizontalTextAlignment="Center" />
                        <Button Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€Ð²ÑƒÑŽ ÐºÐ°Ñ€Ñ‚Ñƒ"
                                Clicked="OnAddCardClicked"
                                BackgroundColor="#FF9800"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="40" />
                    </VerticalStackLayout>
                </Border>

                <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÐ°Ñ€Ñ‚ -->
                <CollectionView x:Name="cardsCollectionView"
                                SelectionMode="None"
                                ItemsLayout="VerticalList"
                                VerticalOptions="FillAndExpand">

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="0" 
                                   StrokeShape="RoundRectangle 10"
                                   Margin="0,0,0,10"
                                   BackgroundColor="White">


                                <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" 
                                      ColumnDefinitions="*,Auto"
                                      Padding="20">
                                    <!-- Ð’ÐµÑ€Ñ…Ð½ÑÑ Ñ‡Ð°ÑÑ‚ÑŒ: ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ -->
                                    <Label Grid.Row="0" Grid.Column="0"
                                           Text="{Binding CardName}"
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           TextColor="#212121" />
                                    <Button Grid.Row="0" Grid.Column="1"
                                            Text="{Binding IsFavorite}"
                                            Clicked="OnFavoritesClicked"
                                            BackgroundColor="Transparent"
                                            TextColor="#FF4081"
                                            FontSize="20"
                                            WidthRequest="40"
                                            HeightRequest="40"
                                            Padding="0" />
                                    <!-- ÐœÐ°Ð³Ð°Ð·Ð¸Ð½ Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ -->
                                    <Label Grid.Row="3" Grid.Column="0" Text="{Binding Shop.ShopName, StringFormat='ÐœÐ°Ð³Ð°Ð·Ð¸Ð½: {0}'}"
                                               FontSize="12"
                                               TextColor="#757575" />
                                    <Label Grid.Row="4" Grid.Column="0" Text="{Binding Category.CategoryName, StringFormat='ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: {0}'}"
                                               FontSize="12"
                                               TextColor="#757575" />
                                        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ -->
                                    <HorizontalStackLayout Grid.Row="5" Grid.Column="0"
                                                           Grid.ColumnSpan="0"
                                                           Spacing="20"
                                                           Margin="0,35,0,0">
                                        
                                        <Button Text="ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½ÐµÐµ"
                                                Clicked="OnDetailsClicked"
                                                BackgroundColor="#757575"
                                                CornerRadius="10"
                                                
                                                TextColor="White"
                                                FontSize="10"
                                                HorizontalOptions="FillAndExpand"
                                                HeightRequest="35" />
                                        <Button Grid.Row="1" Grid.Column="2"
Text="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"
Clicked="OnDeleteCardClicked"
BackgroundColor="#FFEBEE"
TextColor="#F44336"
CornerRadius="10"
FontSize="10"
HorizontalOptions="FillAndExpand"
HeightRequest="35"/>

                                    </HorizontalStackLayout>
                                    
                                    <!-- Gesture Recognizer Ð´Ð»Ñ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ñ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÑƒ -->
                                    <Grid.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnCardTapped" />
                                    </Grid.GestureRecognizers>

                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>

                </CollectionView>

            </VerticalStackLayout>
        </ScrollView>

    </RefreshView>
</ContentPage>